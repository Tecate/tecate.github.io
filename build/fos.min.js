class Desktop extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.selected=null,this.addEventListener("mousedown",t=>{"button"in t&&0===t.button&&this.mouseDown(t)}),this.addEventListener("mouseup",this.mouseUp),this.addEventListener("mousemove",this.mouseMove),this.addEventListener("touchstart",this.mouseDown),this.addEventListener("touchend",this.mouseUp),this.addEventListener("touchmove",this.mouseMove),this.addEventListener("dragstart",t=>t.preventDefault())}mouseUp(){this.selected=null}mouseDown(t){const e=t.path||t.composedPath&&t.composedPath();this.lastX=t.pageX||(t.touches?t.touches[0].pageX:0),this.lastY=t.pageY||(t.touches?t.touches[0].pageY:0);for(let t=0;t<e.length;t++){if("fos-icon"===e[t].localName){this.selected=e[t];break}if("fos-window"===e[t].localName&&e[t].isMoving){this.selected=e[t];break}}}mouseMove(t){if(this.selected)if(t.preventDefault(),"fos-icon"===this.selected.localName){const e=t.pageX||(t.touches?t.touches[0].pageX:0),s=t.pageY||(t.touches?t.touches[0].pageY:0);this.selected.style.left=8*Math.floor(e/8)-this.selected.offsetWidth/2+"px",this.selected.style.top=8*Math.floor(s/8)-this.selected.offsetHeight/2+"px"}else{let e=t.pageX||(t.touches?t.touches[0].pageX:0),s=t.pageY||(t.touches?t.touches[0].pageY:0);this.selected.style.left=this.selected.offsetLeft+(e-this.lastX)+"px",this.selected.style.top=this.selected.offsetTop+(s-this.lastY)+"px",this.lastX=e,this.lastY=s}}static get observedAttributes(){return["iconOffset"]}get iconOffset(){return this.hasAttribute("iconOffset")?this.getAttribute("iconOffset"):null}set iconOffset(t){t?this.setAttribute("iconOffset",t):this.removeAttribute("iconOffset")}attributeChangedCallback(t,e,s){this.render()}connectedCallback(){this.render()}render(){this.shadow.innerHTML="<style>:host{display: block;width: 100%;height: 100%;background-color: #666;}</style><slot></slot>"}}customElements.define("fos-desktop",Desktop);class Icon extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"});const t=document.querySelectorAll("fos-icon").length,e=Math.floor(innerWidth/72),s=parseInt(document.querySelector("fos-desktop").iconOffset)||0;this.top=8+72*Math.floor(t/e)+s,this.left=8+t%e*72,this.dblClick=(()=>{let t=document.querySelector(`fos-window[name=${this.control}] `);t&&(t.style.display="block",t.bringFront())}),this.addEventListener("dblclick",this.dblClick),this.tapedTwice=!1,this.addEventListener("touchstart",t=>{if(!this.tapedTwice)return this.tapedTwice=!0,setTimeout(()=>{this.tapedTwice=!1},300),!1;t.preventDefault(),this.dblClick()})}attributeChangedCallback(t,e,s){this.render()}connectedCallback(){this.render()}static get observedAttributes(){return["href"]}get control(){return this.hasAttribute("href")?this.getAttribute("href"):null}set control(t){t?this.setAttribute("href",t):this.removeAttribute("href")}render(){this.shadow.innerHTML=`<style>:host{display: flex;align-items: center;justify-content: center;position: fixed;top: ${this.top}px;left: ${this.left}px;width: 64px;height: 64px;background-color: rgba(255,50,25,0.9);color: white;line-height: 64px;font-family: Verdana;font-size: 32px;border-radius: 5px;box-shadow: 3px 3px 5px rgba(0,0,0,0.3);overflow: hidden;-webkit-touch-callout: none;-webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none;-ms-user-select: none;    user-select: none;}</style><slot></slot>`}}customElements.define("fos-icon",Icon);class Window extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.isMoving=!1,this.lastTop=this.lastLeft=this.lastWidth=this.lastHeight=null,this.index=900}mouseUp(){this.isMoving=!1}mouseDown(){this.isMoving=!0}maximize(){if(this.lastTop)this.style.top=this.lastTop+"px",this.style.left=this.lastLeft+"px",this.style.width=this.lastWidth+"px",this.style.height=this.lastHeight+"px",this.lastTop=this.lastLeft=this.lastWidth=this.lastHeight=null;else{let t=this.getBoundingClientRect();this.lastTop=t.top,this.lastLeft=t.left,this.lastWidth=t.width,this.lastHeight=t.height,this.style.top=0,this.style.left=0,this.style.width=innerWidth+"px",this.style.height=innerHeight+"px"}}close(){this.style.display="none"}bringFront(){const t=document.querySelectorAll("fos-window");for(const e of t)e.style.zIndex=900;this.style.zIndex=999,this.render()}static get observedAttributes(){return["name","title"]}get name(){return this.hasAttribute("name")?this.getAttribute("name"):null}set name(t){t?this.setAttribute("name",t):this.removeAttribute("name")}get title(){return this.hasAttribute("title")?this.getAttribute("title"):null}set title(t){t?this.setAttribute("title",t):this.removeAttribute("title")}attributeChangedCallback(t,e,s){this.render()}connectedCallback(){const t=document.querySelectorAll("fos-window").length||1;this.top=.2*innerHeight*t/5+60,this.left=.1*innerWidth*t/5,this.render()}render(){this.shadow.innerHTML="";const t=document.createElement("style");t.innerText=`:host{position: fixed;top: ${this.top}px;left: ${this.left}px;width: ${this.width}px;height: ${this.height}px;z-index: ${this.index};min-width: 320px;min-height: 240px;background-color: white;display: none;border: solid 2px #666;box-shadow: 5px 5px 5px;resize: both;overflow: auto;}#buttons{position: absolute;right: 0;top: 0;}#window{display: flex;flex-flow: column;height: 100%;}#top{flex: 0 1 auto;width: 100%;text-align: center;background-color: #888;cursor: move;position: relative;}#top > div > button {height: 25px;}#winTitle{line-height: 25px;cursor: inherit;}#content{flex: 1 1 auto;overflow: auto;position: relative;}#border{height: 10px;flex: 0 0 auto;}    `;const e=document.createElement("div");e.id="window",e.addEventListener("click",()=>{this.bringFront()});const s=document.createElement("div");s.id="top",s.addEventListener("mousedown",()=>{this.mouseDown()}),s.addEventListener("mouseup",()=>{this.mouseUp()}),s.addEventListener("touchstart",()=>{this.mouseDown()}),s.addEventListener("touchend",()=>{this.mouseUp()});const n=document.createElement("div");n.id="winTitle",n.innerText=this.title;const i=document.createElement("div");i.id="buttons";const o=document.createElement("button");o.innerText="[]",o.addEventListener("click",()=>{this.maximize()});const l=document.createElement("button");l.innerText="x",l.addEventListener("click",()=>{this.close()}),i.appendChild(o),i.appendChild(l),s.appendChild(n),s.appendChild(i);const h=document.createElement("div");h.id="content";const r=document.createElement("slot");h.appendChild(r);const d=document.createElement("div");d.id="border",e.appendChild(s),e.appendChild(h),e.appendChild(d),this.shadow.appendChild(t),this.shadow.appendChild(e)}}customElements.define("fos-window",Window);class Bar extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"})}attributeChangedCallback(t,e,s){this.render()}connectedCallback(){this.render()}static get observedAttributes(){return["position"]}get position(){return this.hasAttribute("position")?this.getAttribute("position"):"bottom"}set position(t){!t||"top"!==t&&"bottom"!==t?this.removeAttribute("position"):this.setAttribute("position",t)}render(){this.shadow.innerHTML=`<style>:host{position: absolute;${this.position}: 0;left: 0;z-index: 1000;background-color: #AAA;width: 100%;height: 40px;display: flex;align-items: center;justify-content: flex-start;box-shadow: 0px 0px 5px black;box-sizing: border-box;padding-left: 10px;}</style><slot></slot>`}}customElements.define("fos-bar",Bar);class Menu extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.addEventListener("click",t=>{const e=document.querySelectorAll("fos-menu");for(const t of e)t.visible=!1;this.visible=!0}),document.body.addEventListener("click",t=>{"fos-menu"!==t.target.localName&&(this.visible=!1)})}attributeChangedCallback(t,e,s){this.render()}connectedCallback(){this.render()}static get observedAttributes(){return["name","visible"]}get visible(){return!!this.hasAttribute("visible")}set visible(t){t?this.setAttribute("visible",!0):this.removeAttribute("visible")}get name(){return this.hasAttribute("name")?this.getAttribute("name"):null}set name(t){t?this.setAttribute("name",t):this.removeAttribute("name")}render(){this.shadow.innerHTML="<style>:host{display: inline-block;cursor: default;}#menu{display: "+(this.visible?"block":"none")+";position: absolute;"+(this.parentNode?this.parentNode.position:"bottom")+": 40px;background-color: #AAA;padding: 1em;border: solid 1px black;border-"+(this.parentNode?this.parentNode.position:"bottom")+`: 0;}#title:hover{color: gray;}</style><div><div id="title">${this.name}</div><div id="menu"><slot></slot></div></div>`}}customElements.define("fos-menu",Menu);class MenuItem extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"}),this.addEventListener("click",t=>{let e=this.parentNode;do{e=e.parentNode}while("fos-bar"!==e.localName);let s=e.parentNode.querySelector(`*[name=${this.control}] `);s&&(s.style.display="block",s.bringFront())})}attributeChangedCallback(t,e,s){this.render()}connectedCallback(){this.render()}static get observedAttributes(){return["href"]}get control(){return this.hasAttribute("href")?this.getAttribute("href"):null}set control(t){t?this.setAttribute("href",t):this.removeAttribute("href")}render(){this.shadow.innerHTML="<style>:host{display:block;background-color: inherit;}div:hover{color: gray;}</style><div><slot></slot></div>"}}customElements.define("fos-menu-item",MenuItem);class Panel extends HTMLElement{constructor(){super(),this.shadow=this.attachShadow({mode:"open"})}attributeChangedCallback(t,e,s){this.render()}connectedCallback(){this.render()}bringFront(){const t=this.parentNode.querySelectorAll("fos-panel");for(const e of t)e.style.display="none",e.selected=!1;this.style.display="block",this.selected=!0}static get observedAttributes(){return["name","selected"]}get selected(){return!!this.hasAttribute("selected")}set selected(t){t?this.setAttribute("selected",!0):this.removeAttribute("selected")}get name(){return this.hasAttribute("name")?this.getAttribute("name"):null}set name(t){t?this.setAttribute("name",t):this.removeAttribute("name")}render(){this.shadow.innerHTML="<style>:host{display: "+(this.selected?"block":"none")+";}</style><slot></slot>"}}customElements.define("fos-panel",Panel);